Сологуб Алина Денисовна
БПИ213
Вариант 13
Задача о гостинице – 2 (умные клиенты). В гостинице 10
номеров с ценой 2000 рублей, 10 номеров с ценой 4000 рублей и
5 номеров с ценой 6000 руб. Клиент, зашедший в гостиницу, обладает некоторой (случайной) суммой и получает номер по своим
финансовым возможностям, если тот свободен. При наличии денег и разных по стоимости номеров он выбирает случайный номер.
Если доступных по цене свободных номеров нет, клиент уходит искать ночлег в другое место. Клиенты порождаются динамически и
уничтожаются при освобождении номера или уходе из гостиницы
при невозможности оплаты. Создать приложение, моделирующее работу гостиницы. Каждого клиента реализовать в виде
отдельного процесса
Сценарий решаемой задачи:

Создание общей памяти и инициализация переменных.
1.1. Создание структуры shared_data_t, содержащей информацию о количестве свободных номеров каждого типа, а также о количестве номеров каждого типа в общем.
1.2. Инициализация свободных номеров и номеров каждого типа.
1.3. Создание семафоров для синхронизации доступа к общей памяти.

Создание процессов для каждого клиента.
2.1. Генерация случайного количества денег для каждого клиента.
2.2. Ожидание случайного времени перед попыткой забронировать номер.
2.3. Попытка забронировать номер:
2.3.1. Выбор случайного типа номера в зависимости от наличия средств.
2.3.2. Попытка забронировать номер выбранного типа:
2.3.2.1. Блокировка семафора для соответствующего типа номера.
2.3.2.2. Поиск свободного номера выбранного типа.
2.3.2.3. Если свободный номер найден, его резервирование и уменьшение счетчика свободных номеров выбранного типа.
2.3.2.4. Разблокировка семафора для соответствующего типа номера.
2.3.3. Если номер не забронирован, клиент ищет ночлег в другом месте.

Освобождение зарезервированных номеров при уходе клиента.
3.1. Блокировка семафора для соответствующего типа номера.
3.2. Освобождение зарезервированного номера и увеличение счетчика свободных номеров выбранного типа.
3.3. Разблокировка семафора для соответствующего типа номера.

Обработка сигнала SIGINT.
4.1. Освобождение общей памяти и семафоров.
4.2. Завершение работы программы.
